<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.26">
<meta name="keywords" content="Java,JDK,Java source,Collection,ArrayList,Map,List,HashMap,ArrayDeque,Deque,Set,HashSet,LinkedList,Queue,TreeMap,TreeSet,Vector,Stack">
<meta name="author" content="Dç“œå“¥">
<meta name="copyright" content="Apache-2.0">
<meta property="og:title" content="java.util.concurrent.ThreadPoolExecutor">
<title>JDK æºç åˆ†æ: 58. ThreadPoolExecutor æºç åˆ†æ</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<link rel="stylesheet" href="assets/styles/asciidoctor.css">
<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="assets/styles/rouge-github.css">
<style>
    a {
        text-decoration: none;
    }

    .img_bk {
        text-align: center;
    }

    p > code, strong > code, div.admonitionblock tr > td.content > code {
        color: #d14 !important;
        background-color: #f5f5f5 !important;
        border: 1px solid #e1e1e8;
        white-space: nowrap;
        border-radius: 3px;
    }
</style>
<link rel="stylesheet" href="assets/styles/asciidoctor-tabs.css">
<style>.toc-current{color:#d14;font-size:130%;font-weight: bold;} .toc-root{font-family: "Open Sans","DejaVu Sans",sans-serif;
                       font-size: 0.9em;} #content{display: flex; flex-direction: column; flex: 1 1 auto;}
             .nav-footer{text-align: center; margin-top: auto;}
             .nav-footer > p > a {white-space: nowrap;}</style>
</head>
<body id="java.util.concurrent.ThreadPoolExecutor" class="book toc2 toc-left">
<div id="header">
<h1>JDK æºç åˆ†æ: 58. ThreadPoolExecutor æºç åˆ†æ</h1>
<div class="details">
<span id="author" class="author">Dç“œå“¥</span><br>
<span id="email" class="email"><a href="https://www.diguage.com" class="bare">https://www.diguage.com</a></span><br>
<span id="revdate">2025-11-25</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<p><span class="toc-root"><a href="index.html">JDK æºç åˆ†æ</a></span></p><ul class="sectlevel1">
<li><a href="preface.html">å‰è¨€ï¼šJDK &amp; STL æºç åˆ†æè®¡åˆ’</a>
</li>
<li><a href="overview.html">1. é›†åˆç±»æ¦‚è¿°</a>
</li>
<li><a href="java.util.Iterator.html">2. è¿­ä»£å™¨ Iteratorã€ Enumerationã€ Spliterator ä¸ Iterable</a>
</li>
<li><a href="java.util.Collection.html">3. Collection</a>
</li>
<li><a href="java.util.AbstractCollection.html">4. AbstractCollection</a>
</li>
<li><a href="java.util.List.html">5. List</a>
</li>
<li><a href="java.util.AbstractList.html">6. AbstractList</a>
</li>
<li><a href="java.util.AbstractSequentialList.html">7. AbstractSequentialList</a>
</li>
<li><a href="java.util.ArrayList.html">8. <code>ArrayList</code></a>
</li>
<li><a href="java.util.LinkedList.html">9. LinkedList</a>
</li>
<li><a href="java.util.Stack.html">10. Stack</a>
</li>
<li><a href="java.util.Vector.html">11. Vector</a>
</li>
<li><a href="java.util.Set.html">12. Set</a>
</li>
<li><a href="java.util.AbstractSet.html">13. AbstractSet</a>
</li>
<li><a href="java.util.SortedSet.html">14. SortedSet</a>
</li>
<li><a href="java.util.NavigableSet.html">15. NavigableSet</a>
</li>
<li><a href="java.util.HashSet.html">16. HashSet</a>
</li>
<li><a href="java.util.TreeSet.html">17. TreeSet</a>
</li>
<li><a href="java.util.LinkedHashSet.html">18. LinkedHashSet</a>
</li>
<li><a href="java.util.BitSet.html">19. BitSet</a>
</li>
<li><a href="java.util.EnumSet.html">20. EnumSet</a>
</li>
<li><a href="java.util.Map.html">21. Map</a>
</li>
<li><a href="java.util.SortedMap.html">22. SortedMap</a>
</li>
<li><a href="java.util.NavigableMap.html">23. NavigableMap</a>
</li>
<li><a href="java.util.AbstractMap.html">24. AbstractMap</a>
</li>
<li><a href="java.util.HashMap.html">25. HashMap</a>
</li>
<li><a href="java.util.TreeMap.html">26. TreeMap</a>
</li>
<li><a href="java.util.LinkedHashMap.html">27. LinkedHashMap</a>
</li>
<li><a href="java.util.Dictionary.html">28. Dictionary</a>
</li>
<li><a href="java.util.Hashtable.html">29. Hashtable</a>
</li>
<li><a href="java.util.EnumMap.html">30. EnumMap</a>
</li>
<li><a href="java.util.WeakHashMap.html">31. WeakHashMap</a>
</li>
<li><a href="java.util.IdentityHashMap.html">32. IdentityHashMap</a>
</li>
<li><a href="java.util.Queue.html">33. Queue</a>
</li>
<li><a href="java.util.Deque.html">34. Deque</a>
</li>
<li><a href="java.util.AbstractQueue.html">35. AbstractQueue</a>
</li>
<li><a href="java.util.ArrayDeque.html">36. ArrayDeque</a>
</li>
<li><a href="java.util.PriorityQueue.html">37. PriorityQueue</a>
</li>
<li><a href="java.util.Array.html">38. å·¥å…·ç±» <code>Arrays</code></a>
</li>
<li><a href="java.util.Collection.html">39. å·¥å…·ç±» <code>Collections</code></a>
</li>
<li><a href="concurrent.overview.html">40. å¹¶å‘åº“æ¦‚è¿°</a>
</li>
<li><a href="java.lang.Thread.html">41. Thread</a>
</li>
<li><a href="java.util.concurrent.locks.LockSupport.html">42. LockSupport</a>
</li>
<li><a href="java.util.concurrent.locks.AbstractQueuedSynchronizer.html">43. AbstractQueuedSynchronizer</a>
</li>
<li><a href="java.util.concurrent.locks.ReentrantLock.html">44. ReentrantLock</a>
</li>
<li><a href="java.util.concurrent.locks.ReentrantReadWriteLock.html">45. ReentrantReadWriteLock</a>
</li>
<li><a href="java.util.concurrent.locks.StampedLock.html">46. StampedLock</a>
</li>
<li><a href="java.util.concurrent.Semaphore.html">47. Semaphore</a>
</li>
<li><a href="java.util.concurrent.CountDownLatch.html">48. CountDownLatch</a>
</li>
<li><a href="java.util.concurrent.CyclicBarrier.html">49. CyclicBarrier</a>
</li>
<li><a href="java.util.concurrent.Phaser.html">50. Phaser</a>
</li>
<li><a href="java.util.concurrent.Exchanger.html">51. Exchanger</a>
</li>
<li><a href="java.lang.ThreadLocal.html">52. ThreadLocal</a>
</li>
<li><a href="java.util.concurrent.atomic.AtomicInteger.html">53. AtomicInteger</a>
</li>
<li><a href="java.util.concurrent.atomic.LongAdder.html">54. LongAdder</a>
</li>
<li><a href="java.util.concurrent.Future.html">55. JUC åŒ…åŸºç¡€ç±»åˆ†æ</a>
</li>
<li><a href="java.util.concurrent.FutureTask.html">56. FutureTask</a>
</li>
<li><a href="java.util.concurrent.CompletableFuture.html">57. CompletableFuture</a>
</li>
<li><a href="java.util.concurrent.ThreadPoolExecutor.html"><span class="toc-current">58. ThreadPoolExecutor æºç åˆ†æ</span></a>
</li>
<li><a href="java.util.concurrent.ForkJoinTask.html">59. ForkJoinTask</a>
</li>
<li><a href="java.util.concurrent.ForkJoinPool.html">60. ForkJoinPool</a>
</li>
<li><a href="java.util.concurrent.ConcurrentHashMap.html">61. <code>ConcurrentHashMap</code></a>
</li>
<li><a href="java.util.concurrent.ConcurrentSkipListMap.html">62. <code>ConcurrentSkipListMap</code></a>
</li>
<li><a href="java.util.concurrent.CopyOnWriteArrayList.html">63. CopyOnWriteArrayList</a>
</li>
<li><a href="java.util.concurrent.ConcurrentLinkedQueue.html">64. ConcurrentLinkedQueue</a>
</li>
<li><a href="java.util.concurrent.ArrayBlockingQueue.html">65. ArrayBlockingQueue</a>
</li>
<li><a href="java.util.concurrent.LinkedBlockingQueue.html">66. LinkedBlockingQueue</a>
</li>
<li><a href="java.util.concurrent.PriorityBlockingQueue.html">67. PriorityBlockingQueue</a>
</li>
<li><a href="java.util.concurrent.DelayQueue.html">68. DelayQueue</a>
</li>
<li><a href="java.util.concurrent.ScheduledThreadPoolExecutor.html">69. <code>ScheduledThreadPoolExecutor</code></a>
</li>
<li><a href="java.util.concurrent.Flow.html">70. <code>Flow</code></a>
</li>
<li><a href="java.lang.ClassLoader.html">71. ClassLoader</a>
</li>
<li><a href="java.lang.reflect.Field.html">72. Field</a>
</li>
<li><a href="java.lang.reflect.Proxy.html">73. Proxy</a>
</li>
<li><a href="java.net.ServerSocket.html">74. ServerSocket</a>
</li>
<li><a href="java.util.ServiceLoader.html">75. <code>ServiceLoader</code></a>
</li>
<li><a href="java.lang.String.html">76. <code>String</code></a>
</li>
<li><a href="java.util.Date.html">77. <code>Date</code></a>
</li>
<li><a href="java.io.Serializable.html">78. <code>Serializable</code></a>
</li>
<li><a href="java.regex.Pattern.html">79. <code>Pattern</code></a>
</li>
<li><a href="_netty.html">80. Netty</a>
</li>
</ul>
</div>
</div>
<div id="content"><div class="sect2"><h3 id="_å‹æƒ…æ”¯æŒ">å‹æƒ…æ”¯æŒ</h3><div class="paragraph"><p>å¦‚æœæ‚¨è§‰å¾—è¿™ä¸ªç¬”è®°å¯¹æ‚¨æœ‰æ‰€å¸®åŠ©ï¼Œçœ‹åœ¨Dç“œå“¥ç è¿™ä¹ˆå¤šå­—çš„è¾›è‹¦ä¸Šï¼Œè¯·å‹æƒ…æ”¯æŒä¸€ä¸‹ï¼ŒDç“œå“¥æ„Ÿæ¿€ä¸å°½ï¼ŒğŸ˜œ</p></div><table class="tableblock frame-none grid-all stretch"><colgroup><col style="width: 50%;"><col style="width: 50%;"></colgroup><tbody><tr><td class="tableblock halign-center valign-top"><p class="tableblock"><span class="image"><img src="assets/images/alipay.png" alt="æ”¯ä»˜å®" width="85%" title="æ”¯ä»˜å®"></span></p></td><td class="tableblock halign-center valign-top"><p class="tableblock"><span class="image"><img src="assets/images/wxpay.jpg" alt="å¾®ä¿¡" width="85%" title="å¾®ä¿¡"></span></p></td></tr></tbody></table><div class="paragraph"><p>æœ‰äº›æ‰“èµçš„æœ‹å‹å¸Œæœ›å¯ä»¥åŠ ä¸ªå¥½å‹ï¼Œæ¬¢è¿å…³æ³¨D ç“œå“¥çš„å¾®ä¿¡å…¬ä¼—å·ï¼Œè¿™æ ·å°±å¯ä»¥é€šè¿‡å…¬ä¼—å·çš„å›å¤ç›´æ¥ç»™æˆ‘å‘ä¿¡æ¯ã€‚</p></div><div class="paragraph"><p><span class="image"><img src="assets/images/wx-jikerizhi.png" alt="wx jikerizhi" width="98%"></span></p></div><div class="admonitionblock tip"><table><tbody><tr><td class="icon"><i class="fa icon-tip" title="Tip"></i></td><td class="content"><strong>å…¬ä¼—å·çš„å¾®ä¿¡å·æ˜¯: <code>jikerizhi</code></strong>ã€‚<em>å› ä¸ºä¼—æ‰€å‘¨çŸ¥çš„åŸå› ï¼Œæœ‰æ—¶å›¾ç‰‡åŠ è½½ä¸å‡ºæ¥ã€‚ å¦‚æœå›¾ç‰‡åŠ è½½ä¸å‡ºæ¥å¯ä»¥ç›´æ¥é€šè¿‡æœç´¢å¾®ä¿¡å·æ¥æŸ¥æ‰¾æˆ‘çš„å…¬ä¼—å·ã€‚</em></td></tr></tbody></table></div></div>
<div class="sect1">
<h2 id="java.util.concurrent.ThreadPoolExecutor"><a class="anchor" href="#java.util.concurrent.ThreadPoolExecutor"></a>58. ThreadPoolExecutor æºç åˆ†æ</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 10.1123%;">
<col style="width: 37.0786%;">
<col style="width: 10.1123%;">
<col style="width: 42.6968%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">çŠ¶æ€åç§°</th>
<th class="tableblock halign-left valign-top">æ¯”ç‰¹ä½</th>
<th class="tableblock halign-left valign-top">åè¿›åˆ¶</th>
<th class="tableblock halign-left valign-top">æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RUNNING</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">111-00000000000000000000000000000</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">-536870912</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">è¿è¡Œä¸­çŠ¶æ€ï¼Œå¯ä»¥æ¥æ”¶æ–°çš„ä»»åŠ¡å’Œæ‰§è¡Œä»»åŠ¡é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SHUTDOWN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">000-00000000000000000000000000000</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">shutdownçŠ¶æ€ï¼Œä¸å†æ¥æ”¶æ–°çš„ä»»åŠ¡ï¼Œä½†æ˜¯ä¼šæ‰§è¡Œä»»åŠ¡é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">STOP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">001-00000000000000000000000000000</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">536870912</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">åœæ­¢çŠ¶æ€ï¼Œä¸å†æ¥æ”¶æ–°çš„ä»»åŠ¡ï¼Œä¹Ÿä¸ä¼šæ‰§è¡Œä»»åŠ¡é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡ï¼Œä¸­æ–­æ‰€æœ‰æ‰§è¡Œä¸­çš„ä»»åŠ¡</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TIDYING</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">010-00000000000000000000000000000</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">1073741824</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">æ•´ç†ä¸­çŠ¶æ€ï¼Œæ‰€æœ‰ä»»åŠ¡å·²ç»ç»ˆç»“ï¼Œå·¥ä½œçº¿ç¨‹æ•°ä¸º0ï¼Œè¿‡æ¸¡åˆ°æ­¤çŠ¶æ€çš„å·¥ä½œçº¿ç¨‹ä¼šè°ƒç”¨é’©å­æ–¹æ³• <code>terminated()</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TERMINATED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">011-00000000000000000000000000000</p></td>
<td class="tableblock halign-right valign-top"><p class="tableblock">1610612736</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ç»ˆç»“çŠ¶æ€ï¼Œé’©å­æ–¹æ³• <code>terminated()</code> æ‰§è¡Œå®Œæ¯•</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>ç”±äºè¿è¡ŒçŠ¶æ€å€¼å­˜æ”¾åœ¨é«˜3ä½ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥é€šè¿‡åè¿›åˆ¶å€¼ï¼ˆç”šè‡³å¯ä»¥å¿½ç•¥ä½29ä½ï¼Œç›´æ¥ç”¨ctlè¿›è¡Œæ¯”è¾ƒï¼Œæˆ–è€…ä½¿ç”¨ctlå’Œçº¿ç¨‹æ± çŠ¶æ€å¸¸é‡è¿›è¡Œæ¯”è¾ƒï¼‰æ¥æ¯”è¾ƒå’Œåˆ¤æ–­çº¿ç¨‹æ± çš„çŠ¶æ€ï¼šå·¥ä½œçº¿ç¨‹æ•°ä¸º0çš„å‰æä¸‹ï¼š<code>RUNNING(-536870912)</code> &lt; <code>SHUTDOWN(0)</code> &lt; <code>STOP(536870912)</code> &lt; <code>TIDYING(1073741824)</code> &lt; <code>TERMINATED(1610612736)</code>ã€‚</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./assets/images/ThreadPoolExecutor-states.jpeg" alt="ThreadPoolExecutor states">
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="java"><table class="linenotable"><tbody><tr><td class="linenos gl"><pre class="lineno"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
</pre></td><td class="code"><pre>    <span class="cm">/**
     * Executes the given task sometime in the future.  The task
     * may execute in a new thread or in an existing pooled thread.
     *
     * If the task cannot be submitted for execution, either because this
     * executor has been shutdown or because its capacity has been reached,
     * the task is handled by the current {@link RejectedExecutionHandler}.
     *
     * @param command the task to execute
     * @throws RejectedExecutionException at discretion of
     *         {@code RejectedExecutionHandler}, if the task
     *         cannot be accepted for execution
     * @throws NullPointerException if {@code command} is null
     */</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">execute</span><span class="o">(</span><span class="nc">Runnable</span> <span class="n">command</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">command</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">NullPointerException</span><span class="o">();</span>
        <span class="cm">/*
         * Proceed in 3 steps:
         *
         * 1. If fewer than corePoolSize threads are running, try to
         * start a new thread with the given command as its first
         * task.  The call to addWorker atomically checks runState and
         * workerCount, and so prevents false alarms that would add
         * threads when it shouldn't, by returning false.
         *
         * 2. If a task can be successfully queued, then we still need
         * to double-check whether we should have added a thread
         * (because existing ones died since last checking) or that
         * the pool shut down since entry into this method. So we
         * recheck state and if necessary roll back the enqueuing if
         * stopped, or start a new thread if there are none.
         *
         * 3. If we cannot queue task, then we try to add a new
         * thread.  If it fails, we know we are shut down or saturated
         * and so reject the task.
         */</span>
        <span class="kt">int</span> <span class="n">c</span> <span class="o">=</span> <span class="n">ctl</span><span class="o">.</span><span class="na">get</span><span class="o">();</span>
        <span class="c1">// å¦‚æœå½“å‰å·¥ä½œçº¿ç¨‹æ•°å°äºæ ¸å¿ƒçº¿ç¨‹æ•°ï¼Œåˆ™åˆ›å»ºæ–°çš„çº¿ç¨‹å¹¶æ‰§è¡Œä¼ å…¥çš„ä»»åŠ¡</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">workerCountOf</span><span class="o">(</span><span class="n">c</span><span class="o">)</span> <span class="o">&lt;</span> <span class="n">corePoolSize</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">addWorker</span><span class="o">(</span><span class="n">command</span><span class="o">,</span> <span class="kc">true</span><span class="o">))</span>
                <span class="c1">// åˆ›å»ºæ ¸å¿ƒçº¿ç¨‹æˆåŠŸåˆ™ç›´æ¥è¿”å›</span>
                <span class="k">return</span><span class="o">;</span>
            <span class="c1">// åˆ›å»ºæ ¸å¿ƒçº¿ç¨‹å¤±è´¥ï¼Œåˆ™åœ¨å…¶ä»–ä»»åŠ¡æäº¤æ—¶ï¼Œå·²ç»åˆ›å»ºäº†è¶³å¤Ÿå¤šçš„çº¿ç¨‹æ•°</span>
            <span class="c1">// æˆ–è€…çº¿ç¨‹æ± å…³é—­ç­‰ç­‰ï¼Œæ€»ä¹‹çº¿ç¨‹æ± çŠ¶æ€å·²ç»å‘ç”Ÿå˜åŒ–ï¼Œ</span>
            <span class="c1">// åˆ™æ›´æ–° ctl çš„ä¸´æ—¶å˜é‡</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">ctl</span><span class="o">.</span><span class="na">get</span><span class="o">();</span>
        <span class="o">}</span>
        <span class="c1">// è¿è¡Œåˆ°è¿™é‡Œè¯´æ˜åˆ›å»ºæ ¸å¿ƒçº¿ç¨‹å¤±è´¥ï¼Œåˆ™å½“å‰å·¥ä½œçº¿ç¨‹å·²ç»å¤§äºç­‰äº corePoolSize</span>
        <span class="c1">// åˆ¤æ–­çº¿ç¨‹æ± æ˜¯å¦è¿è¡Œå¹¶ä¸”å°è¯•ç”¨éé˜»å¡æ–¹æ³•å‘ä»»åŠ¡é˜Ÿåˆ—ä¸­æ·»åŠ ä»»åŠ¡ï¼ˆå¤±è´¥åˆ™è¿”å› falseï¼‰</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">isRunning</span><span class="o">(</span><span class="n">c</span><span class="o">)</span> <span class="o">&amp;&amp;</span> <span class="n">workQueue</span><span class="o">.</span><span class="na">offer</span><span class="o">(</span><span class="n">command</span><span class="o">))</span> <span class="o">{</span>
            <span class="kt">int</span> <span class="n">recheck</span> <span class="o">=</span> <span class="n">ctl</span><span class="o">.</span><span class="na">get</span><span class="o">();</span>
            <span class="c1">// å‘ä»»åŠ¡é˜Ÿåˆ—æŠ•æ”¾ä»»åŠ¡æˆåŠŸï¼Œå¯¹çº¿ç¨‹æ± çŠ¶æ€åšäºŒæ¬¡æ£€æŸ¥</span>
            <span class="c1">// å¦‚æœçº¿ç¨‹æ± çŠ¶æ€ä¸æ˜¯è¿è¡Œä¸­ï¼Œåˆ™ä»ä»»åŠ¡é˜Ÿåˆ—ä¸­ç§»é™¤ä»»åŠ¡å¹¶æ‰§è¡Œæ‹’ç»ç­–ç•¥</span>
            <span class="k">if</span> <span class="o">(!</span> <span class="n">isRunning</span><span class="o">(</span><span class="n">recheck</span><span class="o">)</span> <span class="o">&amp;&amp;</span> <span class="n">remove</span><span class="o">(</span><span class="n">command</span><span class="o">))</span>
                <span class="c1">// æ‰§è¡Œæ‹’ç»ç­–ç•¥ -- ç»“æŸ</span>
                <span class="n">reject</span><span class="o">(</span><span class="n">command</span><span class="o">);</span>
            <span class="c1">// èµ°åˆ°ä¸‹é¢çš„ else if åˆ†æ”¯ï¼Œåˆ™è¯´æ˜</span>
            <span class="c1">// 0ã€çº¿ç¨‹æ± å¯èƒ½æ˜¯ RUNNING çŠ¶æ€</span>
            <span class="c1">// 1ã€ä»»åŠ¡ç§»é™¤å¤±è´¥ï¼ˆå¤±è´¥åŸå› å¯èƒ½æ˜¯ä»»åŠ¡å·²ç»è¢«æ‰§è¡Œï¼‰</span>
            <span class="c1">// å¦‚æœå½“å‰çº¿ç¨‹æ•°ä¸º0ï¼Œåˆ™åˆ›å»ºä¸€ä¸ªéæ ¸å¿ƒçº¿ç¨‹å¹¶ä¼ å…¥ä»»åŠ¡ä¸º null -- ç»“æŸ</span>
            <span class="c1">// åˆ›å»ºçš„çº¿ç¨‹ä¸ä¼šé©¬ä¸Šæ‰§è¡Œä»»åŠ¡ï¼Œè€Œæ˜¯ç­‰å¾…è·å–ä»»åŠ¡é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡å»æ‰§è¡Œ</span>
            <span class="c1">// å¦‚æœå½“å‰çº¿ç¨‹æ•°ä¸ä¸º0ï¼Œåˆ™ä»€ä¹ˆä¹Ÿä¸åšã€‚å› ä¸ºä»»åŠ¡å·²ç»æˆåŠŸåŠ å…¥é˜Ÿåˆ—ï¼Œæ€»ä¼šæ‰§è¡Œã€‚</span>
            <span class="k">else</span> <span class="nf">if</span> <span class="o">(</span><span class="n">workerCountOf</span><span class="o">(</span><span class="n">recheck</span><span class="o">)</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span>
                <span class="n">addWorker</span><span class="o">(</span><span class="kc">null</span><span class="o">,</span> <span class="kc">false</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="c1">// æ‰§è¡Œåˆ°è¿™é‡Œè¯´æ˜ï¼š</span>
        <span class="c1">// 0ã€çº¿ç¨‹æ± ä¸­çš„å·¥ä½œçº¿ç¨‹æ€»æ•°å·²ç»å¤§äºç­‰äº corePoolSize</span>
        <span class="c1">// 1ã€çº¿ç¨‹æ± å¯èƒ½ä¸æ˜¯ RUNNING çŠ¶æ€</span>
        <span class="c1">// 2ã€çº¿ç¨‹æ± å¯èƒ½æ˜¯ RUNNING çŠ¶æ€åŒæ—¶ä»»åŠ¡é˜Ÿåˆ—å·²ç»æ»¡äº†</span>
        <span class="c1">// å¦‚æœå‘ä»»åŠ¡é˜Ÿåˆ—æŠ•æ”¾ä»»åŠ¡å¤±è´¥ï¼Œåˆ™ä¼šå°è¯•åˆ›å»ºéæ ¸å¿ƒçº¿ç¨‹ä¼ å…¥ä»»åŠ¡æ‰§è¡Œ</span>
        <span class="c1">// åˆ›å»ºéæ ¸å¿ƒçº¿ç¨‹å¤±è´¥ï¼Œæ­¤æ—¶éœ€è¦æ‹’ç»æ‰§è¡Œä»»åŠ¡</span>
        <span class="k">else</span> <span class="nf">if</span> <span class="o">(!</span><span class="n">addWorker</span><span class="o">(</span><span class="n">command</span><span class="o">,</span> <span class="kc">false</span><span class="o">))</span>
            <span class="c1">// æ‰§è¡Œæ‹’ç»ç­–ç•¥ -- ç»“æŸ</span>
            <span class="n">reject</span><span class="o">(</span><span class="n">command</span><span class="o">);</span>
    <span class="o">}</span>
</pre></td></tr></tbody></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>ä¸ºä»€ä¹ˆéœ€è¦äºŒæ¬¡æ£€æŸ¥çº¿ç¨‹æ± çš„è¿è¡ŒçŠ¶æ€ï¼Œå½“å‰å·¥ä½œçº¿ç¨‹æ•°é‡ä¸º <code>0</code>ï¼Œå°è¯•åˆ›å»ºä¸€ä¸ªéæ ¸å¿ƒçº¿ç¨‹å¹¶ä¸”ä¼ å…¥çš„ä»»åŠ¡å¯¹è±¡ä¸º <code>null</code>ï¼Ÿè¿™ä¸ªå¯ä»¥çœ‹APIæ³¨é‡Šï¼š</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p>å¦‚æœä¸€ä¸ªä»»åŠ¡æˆåŠŸåŠ å…¥ä»»åŠ¡é˜Ÿåˆ—ï¼Œæˆ‘ä»¬ä¾ç„¶éœ€è¦äºŒæ¬¡æ£€æŸ¥æ˜¯å¦éœ€è¦æ·»åŠ ä¸€ä¸ªå·¥ä½œçº¿ç¨‹ï¼ˆå› ä¸ºæ‰€æœ‰å­˜æ´»çš„å·¥ä½œçº¿ç¨‹æœ‰å¯èƒ½åœ¨æœ€åä¸€æ¬¡æ£€æŸ¥ä¹‹åå·²ç»ç»ˆç»“ï¼‰æˆ–è€…æ‰§è¡Œå½“å‰æ–¹æ³•çš„æ—¶å€™çº¿ç¨‹æ± æ˜¯å¦å·²ç» <code>shutdown</code> äº†ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦äºŒæ¬¡æ£€æŸ¥çº¿ç¨‹æ± çš„çŠ¶æ€ï¼Œå¿…è¦æ—¶æŠŠä»»åŠ¡ä»ä»»åŠ¡é˜Ÿåˆ—ä¸­ç§»é™¤æˆ–è€…åœ¨æ²¡æœ‰å¯ç”¨çš„å·¥ä½œçº¿ç¨‹çš„å‰æä¸‹æ–°å»ºä¸€ä¸ªå·¥ä½œçº¿ç¨‹ã€‚</p>
</div>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="./assets/images/ThreadPoolExecutor-process.jpeg" alt="ThreadPoolExecutor process">
</div>
</div>
<div class="paragraph">
<p><code>runWorker()</code> æ–¹æ³•çš„æ ¸å¿ƒæµç¨‹ï¼š</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./assets/images/ThreadPoolExecutor-runWorker.jpeg" alt="ThreadPoolExecutor runWorker">
</div>
</div>
<div class="sect2">
<h3 id="_å¤§çº²"><a class="anchor" href="#_å¤§çº²"></a>58.1. å¤§çº²</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>åŸºæœ¬ä½¿ç”¨</p>
</li>
<li>
<p>ä½¿ç”¨ <code>Executors</code> åˆ›å»ºçº¿ç¨‹æ± </p>
</li>
<li>
<p>è‡ªå®šä¹‰ä»»åŠ¡ï¼Œå¹¶æäº¤ä»»åŠ¡</p>
</li>
<li>
<p>è·å–è¿”å›ç»“æœ</p>
</li>
<li>
<p>çº¿ç¨‹æ± çš„ç±»å›¾ç»“æ„</p>
</li>
<li>
<p>åˆ›å»ºæ‰§è¡Œçº¿ç¨‹</p>
</li>
<li>
<p>å–å‡ºä»»åŠ¡æ‰§è¡Œ</p>
</li>
<li>
<p>å¦‚ä½•å®ç° <code>invokeAny(Collection&lt;? extends Callable&lt;T&gt;&gt; tasks)</code> ï¼Ÿ</p>
</li>
<li>
<p>å¦‚ä½•å®ç° <code>invokeAny(Collection&lt;? extends Callable&lt;T&gt;&gt; tasks, long timeout, TimeUnit unit)</code> ?</p>
</li>
<li>
<p>å¦‚ä½•å®ç° <code>invokeAll(Collection&lt;? extends Callable&lt;T&gt;&gt; tasks)</code> ?</p>
</li>
<li>
<p>å¦‚ä½•å®ç° <code>invokeAll(Collection&lt;? extends Callable&lt;T&gt;&gt; tasks, long timeout, TimeUnit unit)</code> ï¼Ÿ</p>
</li>
<li>
<p>å¦‚ä½•åˆ¤æ–­çº¿ç¨‹è¶…æ—¶ï¼Ÿä»¥åŠè¶…æ—¶åå¦‚ä½•æ€æ‰çº¿ç¨‹ï¼Ÿ</p>
</li>
<li>
<p>å¦‚ä½•ç»ˆæ­¢ä»»åŠ¡ï¼Ÿæ¸©æŸ”ç»ˆæ­¢ï¼Ÿæˆ–è€…é‡è›®ç»ˆæ­¢ï¼Ÿ</p>
</li>
<li>
<p>çº¿ç¨‹æ± åœ¨jDK5ã€6ã€7ä¸­æœ‰å“ªäº›å‡çº§å˜åŒ–ï¼Ÿ</p>
</li>
<li>
<p>æ‹’ç»ç­–ç•¥</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_æ ¸å¿ƒç‚¹_2"><a class="anchor" href="#_æ ¸å¿ƒç‚¹_2"></a>58.2. æ ¸å¿ƒç‚¹</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>å…³é”®å‚æ•°</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p><code>corePoolSize</code></p>
</li>
<li>
<p><code>maximumPoolSize</code></p>
</li>
<li>
<p><code>BlockingQueue</code></p>
</li>
<li>
<p><code>RejectedExecutionHandler</code></p>
</li>
<li>
<p><code>keepAliveTime</code></p>
</li>
<li>
<p><code>threadFactory</code></p>
</li>
</ol>
</div>
</li>
<li>
<p><code>RejectedExecutionHandler</code></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p><code>AbortPolicy</code></p>
</li>
<li>
<p><code>CallerRunsPolicy</code></p>
</li>
<li>
<p><code>DiscardPolicy</code></p>
</li>
<li>
<p><code>DiscardOldestPolicy</code></p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>åœ¨ç”Ÿäº§ç¯å¢ƒï¼Œä¸ºäº†é¿å…é¦–æ¬¡è°ƒç”¨è¶…æ—¶ï¼Œå¯ä»¥è°ƒç”¨ <code>executor.prestartAllCoreThreads()</code> é¢„åˆ›å»ºæ‰€æœ‰ <code>core</code> çº¿ç¨‹ï¼Œé¿å…æ¥ä¸€ä¸ªåˆ›ä¸€ä¸ªå¸¦æ¥é¦–æ¬¡è°ƒç”¨æ…¢çš„é—®é¢˜ã€‚</p>
</div>
</div>
<div class="sect2">
<h3 id="_é—®é¢˜_2"><a class="anchor" href="#_é—®é¢˜_2"></a>58.3. é—®é¢˜</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>ä»»åŠ¡æ·»åŠ åï¼Œå¦‚ä½•æ‰§è¡Œï¼Ÿ</p>
</li>
<li>
<p>ä¸€ä¸ªä»»åŠ¡æ‰§è¡Œå®Œæˆåï¼Œå¦‚ä½•åœ¨åŒä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œä¸‹ä¸€ä¸ªä»»åŠ¡ï¼Ÿ</p>
</li>
<li>
<p>åœ¨ <code>corePoolSize</code> æ¯” <code>maximumPoolSize</code> å°çš„æƒ…å†µä¸‹ï¼Œå¦‚ä½•åˆ¤å®šä¸€ä¸ªçº¿ç¨‹æ˜¯å¦è¶…æ—¶ï¼Ÿå¹¶ä¸”å¦‚ä½•åˆ é™¤ä¸€ä¸ªçº¿ç¨‹ï¼Ÿ</p>
</li>
<li>
<p>ä»»åŠ¡æ·»åŠ åï¼Œ</p>
</li>
<li>
<p>å¦‚ä½•è¿”å›ä»»åŠ¡æ‰§è¡Œçš„ç»“æœï¼Ÿ</p>
</li>
<li>
<p>è¿™ä¸ªçº¿ç¨‹æ± è¿˜æœ‰å“ªäº›å¯ä»¥æ”¹è¿›çš„åœ°æ–¹ï¼Ÿæ¯”å¦‚ Guava ä¸­æä¾›äº†å“ªäº›çº¿ç¨‹æ± ï¼Ÿ</p>
</li>
<li>
<p>å¦‚ä½•æ”¹é€ æˆæ·»åŠ ä»»åŠ¡ï¼Œå¦‚æœæ²¡æœ‰è¾¾åˆ° <code>maxPoolSize</code> åˆ™å…ˆåˆ›å»ºçº¿ç¨‹ï¼Ÿ</p>
</li>
</ol>
</div>
<div class="sect3">
<h4 id="_tomcat_æ”¹è¿›"><a class="anchor" href="#_tomcat_æ”¹è¿›"></a>58.3.1. Tomcat æ”¹è¿›</h4>
<div class="paragraph">
<p>å¯ä¸å¯ä»¥è‡ªå·±å°è£…ä¸€ä¸ªQueueï¼Œåœ¨æ’å…¥æ—¶å¢åŠ ä»¥ä¸‹é€»è¾‘å‘¢ï¼Ÿ</p>
</div>
<div class="ulist">
<ul>
<li>
<p>å¦‚æœå½“å‰æœ‰ç©ºé—²çº¿ç¨‹ç­‰å¾…æ¥å®¢ï¼Œåˆ™æŠŠä»»åŠ¡åŠ å…¥é˜Ÿåˆ—è®©å­©å„¿ä»¬å»æŠ¢ã€‚</p>
</li>
<li>
<p>å¦‚æœæ²¡æœ‰ç©ºé—²çš„äº†ï¼Œæ€»çº¿ç¨‹æ•°åˆæ²¡åˆ°è¾¾maxï¼Œé‚£å°±è¿”å›falseï¼Œè®©Executorå»åˆ›å»ºçº¿ç¨‹ã€‚</p>
</li>
<li>
<p>å¦‚æœæ€»çº¿ç¨‹æ•°å·²è¾¾åˆ°maxï¼Œåˆ™ç»§ç»­æŠŠä»»åŠ¡åŠ å…¥é˜Ÿåˆ—ç¼“å†²ä¸€ä¸‹ã€‚</p>
</li>
<li>
<p>å¦‚æœç¼“å†²é˜Ÿåˆ—ä¹Ÿæ»¡äº†ï¼ŒæŠ›å‡ºæ‹’ç»å¼‚å¸¸ã€‚</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="title"><a href="https://github.com/apache/tomcat/blob/master/java/org/apache/tomcat/util/threads/TaskQueue.java" class="bare">https://github.com/apache/tomcat/blob/master/java/org/apache/tomcat/util/threads/TaskQueue.java</a></div>
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="java"><table class="linenotable"><tbody><tr><td class="linenos gl"><pre class="lineno"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
</pre></td><td class="code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">TaskQueue</span> <span class="kd">extends</span> <span class="nc">LinkedBlockingQueue</span><span class="o">&lt;</span><span class="nc">Runnable</span><span class="o">&gt;</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kd">transient</span> <span class="kd">volatile</span> <span class="nc">ThreadPoolExecutor</span> <span class="n">parent</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">offer</span><span class="o">(</span><span class="nc">Runnable</span> <span class="n">o</span><span class="o">)</span> <span class="o">{</span>
      <span class="c1">//we can't do any checks</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">parent</span><span class="o">==</span><span class="kc">null</span><span class="o">)</span> <span class="k">return</span> <span class="kd">super</span><span class="o">.</span><span class="na">offer</span><span class="o">(</span><span class="n">o</span><span class="o">);</span>
        <span class="c1">//we are maxed out on threads, simply queue the object</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">parent</span><span class="o">.</span><span class="na">getPoolSize</span><span class="o">()</span> <span class="o">==</span> <span class="n">parent</span><span class="o">.</span><span class="na">getMaximumPoolSize</span><span class="o">())</span> <span class="k">return</span> <span class="kd">super</span><span class="o">.</span><span class="na">offer</span><span class="o">(</span><span class="n">o</span><span class="o">);</span>
        <span class="c1">//we have idle threads, just add it to the queue</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">parent</span><span class="o">.</span><span class="na">getSubmittedCount</span><span class="o">()&lt;=(</span><span class="n">parent</span><span class="o">.</span><span class="na">getPoolSize</span><span class="o">()))</span> <span class="k">return</span> <span class="kd">super</span><span class="o">.</span><span class="na">offer</span><span class="o">(</span><span class="n">o</span><span class="o">);</span>
        <span class="c1">//if we have less threads than maximum force creation of a new thread</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">parent</span><span class="o">.</span><span class="na">getPoolSize</span><span class="o">()&lt;</span><span class="n">parent</span><span class="o">.</span><span class="na">getMaximumPoolSize</span><span class="o">())</span> <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
        <span class="c1">//if we reached here, we need to add it to the queue</span>
        <span class="k">return</span> <span class="kd">super</span><span class="o">.</span><span class="na">offer</span><span class="o">(</span><span class="n">o</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>å¦‚ä½•åˆ¤æ–­å½“å‰æœ‰æ²¡æœ‰ç©ºé—²çš„çº¿ç¨‹ç­‰å¾…æ¥å®¢ï¼ŸTomcat åˆ™é æ‰©å±• <code>Executor</code>ï¼Œå¢åŠ ä¸€ä¸ªå½“å‰è¯·æ±‚æ•°çš„è®¡æ•°å™¨ï¼Œåœ¨ <code>execute()</code> æ–¹æ³•å‰åŠ 1ï¼Œå†é‡è½½ <code>afterExecute()</code> æ–¹æ³•å‡1ï¼Œç„¶ååˆ¤æ–­å½“å‰çº¿ç¨‹æ€»æ•°æ˜¯å¦å¤§äºå½“å‰è¯·æ±‚æ€»æ•°å°±çŸ¥é“æœ‰å’©æœ‰å›´è§‚ç¾¤ä¼—ã€‚</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_éœ€è¦æ³¨æ„çš„ç‚¹"><a class="anchor" href="#_éœ€è¦æ³¨æ„çš„ç‚¹"></a>58.4. éœ€è¦æ³¨æ„çš„ç‚¹</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>çº¿ç¨‹æ± å¦‚ä½•åˆå§‹åŒ–ï¼Ÿ</p>
</li>
<li>
<p>ä»»åŠ¡å¦‚ä½•æ·»åŠ ï¼Ÿ</p>
</li>
<li>
<p>ä»»åŠ¡å¦‚ä½•æ‰§è¡Œï¼Ÿ</p>
</li>
<li>
<p>ä»»åŠ¡å¦‚ä½•ç»ˆæ­¢ï¼Ÿ</p>
</li>
<li>
<p>é‡åˆ°å¼‚å¸¸å¦‚ä½•å¤„ç†ï¼Ÿ</p>
</li>
<li>
<p>çº¿ç¨‹æ± é˜Ÿåˆ—å·²æ»¡ï¼Œå¦‚ä½•æ‹’ç»ï¼Ÿ</p>
</li>
<li>
<p>ä»»åŠ¡æ‰§è¡Œè¿‡ç¨‹ä¸­å‡ºç°å¼‚å¸¸ï¼Œå¦‚ä½•å¤„ç†ï¼Ÿå…³é—­è¯¥çº¿ç¨‹ï¼Œé‡å¯ä¸€ä¸ªå—ï¼Ÿ</p>
</li>
<li>
<p>ï¼Ÿï¼Ÿ</p>
</li>
<li>
<p>ä»»åŠ¡å¦‚ä½•å­˜æ”¾ï¼Ÿ</p>
</li>
<li>
<p>ä»»åŠ¡å­˜æ”¾åï¼Œå¦‚ä½•å–å‡ºæ¥ï¼Ÿ</p>
</li>
<li>
<p>å¦‚ä½•åšåˆ°ä¸æ–­åœ°ä¸€ä¸ªä¸€ä¸ªæ‰§è¡Œä¸‹å»ï¼Ÿ</p>
</li>
<li>
<p>ä¸ºä»€ä¹ˆ <code>Worker</code> ç»§æ‰¿ <code>AbstractQueuedSynchronizer</code> ï¼ŸAQSèµ·ä»€ä¹ˆä½œç”¨ï¼Ÿæ˜¯å¦éœ€è¦å…ˆç ”ç©¶ä¸€ä¸‹ï¼Ÿ</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_æ”¶è·"><a class="anchor" href="#_æ”¶è·"></a>58.5. æ”¶è·</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>å¯ä»¥ç»§æ‰¿ <code>ThreadPoolExecutor</code>ï¼Œå®ç° <code>beforeExecute()</code> å’Œ <code>afterExecute()</code> ç­‰æ–¹æ³•ï¼Œæ¥åŠ å…¥æ‰§è¡Œæ—¶çš„å›è°ƒã€‚ç±»ä¼¼çš„å›è°ƒï¼Œè¿˜æœ‰ <code>terminated()</code></p>
</li>
<li>
<p>æ·»åŠ ä»»åŠ¡æ—¶ï¼Œ <code>execute()</code> æ–¹æ³•çš„ç¬¬äºŒç§æƒ…å†µï¼Œä¸ºä»€ä¹ˆè¿˜æœ‰å†æ¬¡æ£€æŸ¥ï¼Ÿ</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight nowrap"><code data-lang="java"><table class="linenotable"><tbody><tr><td class="linenos gl"><pre class="lineno">  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
</pre></td><td class="code"><pre><span class="kn">package</span> <span class="nn">com.diguage.truman.concurrent</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.Test</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.time.LocalDateTime</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.ArrayList</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.concurrent.Callable</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.concurrent.ExecutionException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.concurrent.Future</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.concurrent.LinkedBlockingQueue</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.concurrent.ThreadPoolExecutor</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.concurrent.TimeUnit</span><span class="o">;</span>

<span class="cm">/**
 * @author Dç“œå“¥, https://www.diguage.com/
 * @since 2020-03-10 10:50
 */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ThreadPoolExecutorTest</span> <span class="o">{</span>

    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">testStatus</span><span class="o">()</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="no">COUNT_BITS</span> <span class="o">=</span> <span class="nc">Integer</span><span class="o">.</span><span class="na">SIZE</span> <span class="o">-</span> <span class="mi">3</span><span class="o">;</span>
        <span class="kt">int</span> <span class="no">COUNT_MASK</span> <span class="o">=</span> <span class="o">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="no">COUNT_BITS</span><span class="o">)</span> <span class="o">-</span> <span class="mi">1</span><span class="o">;</span>

        <span class="c1">// runState is stored in the high-order bits</span>
        <span class="kt">int</span> <span class="no">RUNNING</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="no">COUNT_BITS</span><span class="o">;</span>
        <span class="kt">int</span> <span class="no">SHUTDOWN</span> <span class="o">=</span> <span class="mi">0</span> <span class="o">&lt;&lt;</span> <span class="no">COUNT_BITS</span><span class="o">;</span>
        <span class="kt">int</span> <span class="no">STOP</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="no">COUNT_BITS</span><span class="o">;</span>
        <span class="kt">int</span> <span class="no">TIDYING</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">&lt;&lt;</span> <span class="no">COUNT_BITS</span><span class="o">;</span>
        <span class="kt">int</span> <span class="no">TERMINATED</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">&lt;&lt;</span> <span class="no">COUNT_BITS</span><span class="o">;</span>

        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span><span class="s">"%32s // %d%n"</span><span class="o">,</span> <span class="nc">Integer</span><span class="o">.</span><span class="na">toBinaryString</span><span class="o">(</span><span class="no">RUNNING</span><span class="o">),</span> <span class="no">RUNNING</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span><span class="s">"%32s // %d%n"</span><span class="o">,</span> <span class="nc">Integer</span><span class="o">.</span><span class="na">toBinaryString</span><span class="o">(</span><span class="no">SHUTDOWN</span><span class="o">),</span> <span class="no">SHUTDOWN</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span><span class="s">"%32s // %d%n"</span><span class="o">,</span> <span class="nc">Integer</span><span class="o">.</span><span class="na">toBinaryString</span><span class="o">(</span><span class="no">STOP</span><span class="o">),</span> <span class="no">STOP</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span><span class="s">"%32s // %d%n"</span><span class="o">,</span> <span class="nc">Integer</span><span class="o">.</span><span class="na">toBinaryString</span><span class="o">(</span><span class="no">TIDYING</span><span class="o">),</span> <span class="no">TIDYING</span><span class="o">);</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">printf</span><span class="o">(</span><span class="s">"%32s // %d%n"</span><span class="o">,</span> <span class="nc">Integer</span><span class="o">.</span><span class="na">toBinaryString</span><span class="o">(</span><span class="no">TERMINATED</span><span class="o">),</span> <span class="no">TERMINATED</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">testPoolSize</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">ThreadPoolExecutor</span> <span class="n">executorService</span>
                <span class="o">=</span> <span class="k">new</span> <span class="nc">ThreadPoolExecutor</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">1L</span><span class="o">,</span>
                <span class="nc">TimeUnit</span><span class="o">.</span><span class="na">MINUTES</span><span class="o">,</span> <span class="k">new</span> <span class="nc">LinkedBlockingQueue</span><span class="o">&lt;&gt;(</span><span class="mi">6</span><span class="o">));</span>

        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="n">executorService</span><span class="o">.</span><span class="na">execute</span><span class="o">(</span><span class="k">new</span> <span class="nc">Task</span><span class="o">(</span><span class="s">"Task-"</span> <span class="o">+</span> <span class="n">i</span><span class="o">));</span>
        <span class="o">}</span>
        <span class="n">executorService</span><span class="o">.</span><span class="na">shutdown</span><span class="o">();</span>
        <span class="k">while</span> <span class="o">(!</span><span class="n">executorService</span><span class="o">.</span><span class="na">isTerminated</span><span class="o">())</span> <span class="o">{</span>
        <span class="o">}</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Finish all thread..."</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">testCallable</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">ThreadPoolExecutor</span> <span class="n">executorService</span>
                <span class="o">=</span> <span class="k">new</span> <span class="nc">ThreadPoolExecutor</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">1L</span><span class="o">,</span>
                <span class="nc">TimeUnit</span><span class="o">.</span><span class="na">MINUTES</span><span class="o">,</span> <span class="k">new</span> <span class="nc">LinkedBlockingQueue</span><span class="o">&lt;&gt;(</span><span class="mi">6</span><span class="o">));</span>

        <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Future</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;&gt;</span> <span class="n">futures</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;&gt;(</span><span class="mi">10</span><span class="o">);</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="nc">Future</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">future</span> <span class="o">=</span> <span class="n">executorService</span><span class="o">.</span><span class="na">submit</span><span class="o">(</span>
                    <span class="k">new</span> <span class="nf">CallableTask</span><span class="o">(</span><span class="s">"CallableTask-"</span> <span class="o">+</span> <span class="n">i</span><span class="o">));</span>

            <span class="n">futures</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">future</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">for</span> <span class="o">(</span><span class="nc">Future</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">future</span> <span class="o">:</span> <span class="n">futures</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">try</span> <span class="o">{</span>
                <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="nc">LocalDateTime</span><span class="o">.</span><span class="na">now</span><span class="o">()</span> <span class="o">+</span> <span class="s">"::"</span> <span class="o">+</span> <span class="n">future</span><span class="o">.</span><span class="na">get</span><span class="o">());</span>
            <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">InterruptedException</span> <span class="o">|</span> <span class="nc">ExecutionException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="k">while</span> <span class="o">(!</span><span class="n">executorService</span><span class="o">.</span><span class="na">isTerminated</span><span class="o">())</span> <span class="o">{</span>
        <span class="o">}</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Finish all thread..."</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">testComplete</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">ThreadPoolExecutor</span> <span class="n">executorService</span>
                <span class="o">=</span> <span class="k">new</span> <span class="nc">ThreadPoolExecutor</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="mi">4</span><span class="o">,</span> <span class="mi">1L</span><span class="o">,</span>
                <span class="nc">TimeUnit</span><span class="o">.</span><span class="na">MINUTES</span><span class="o">,</span> <span class="k">new</span> <span class="nc">LinkedBlockingQueue</span><span class="o">&lt;&gt;(</span><span class="mi">6</span><span class="o">));</span>

        <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Future</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;&gt;</span> <span class="n">futures</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;&gt;(</span><span class="mi">10</span><span class="o">);</span>
        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
            <span class="nc">Future</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">future</span> <span class="o">=</span> <span class="n">executorService</span><span class="o">.</span><span class="na">submit</span><span class="o">(</span>
                    <span class="k">new</span> <span class="nf">CallableTask</span><span class="o">(</span><span class="s">"CallableTask-"</span> <span class="o">+</span> <span class="n">i</span><span class="o">));</span>
            <span class="n">futures</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">future</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">for</span> <span class="o">(</span><span class="nc">Future</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">future</span> <span class="o">:</span> <span class="n">futures</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">try</span> <span class="o">{</span>
                <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="nc">LocalDateTime</span><span class="o">.</span><span class="na">now</span><span class="o">()</span> <span class="o">+</span> <span class="s">"::"</span> <span class="o">+</span> <span class="n">future</span><span class="o">.</span><span class="na">get</span><span class="o">());</span>
            <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">InterruptedException</span> <span class="o">|</span> <span class="nc">ExecutionException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="k">while</span> <span class="o">(!</span><span class="n">executorService</span><span class="o">.</span><span class="na">isTerminated</span><span class="o">())</span> <span class="o">{</span>
        <span class="o">}</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Finish all thread..."</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">CallableTask</span> <span class="kd">implements</span> <span class="nc">Callable</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="kd">final</span> <span class="nc">String</span> <span class="n">name</span><span class="o">;</span>

        <span class="kd">public</span> <span class="nf">CallableTask</span><span class="o">(</span><span class="nc">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">this</span><span class="o">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">;</span>
        <span class="o">}</span>

        <span class="nd">@Override</span>
        <span class="kd">public</span> <span class="nc">String</span> <span class="nf">call</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
            <span class="nc">Thread</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="mi">1000</span><span class="o">);</span>
            <span class="c1">//è¿”å›æ‰§è¡Œå½“å‰ Callable çš„çº¿ç¨‹åå­—</span>
            <span class="k">return</span> <span class="nc">Thread</span><span class="o">.</span><span class="na">currentThread</span><span class="o">().</span><span class="na">getName</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="kd">class</span> <span class="nc">Task</span> <span class="kd">implements</span> <span class="nc">Runnable</span> <span class="o">{</span>
        <span class="kd">private</span> <span class="nc">String</span> <span class="n">name</span><span class="o">;</span>

        <span class="kd">public</span> <span class="nf">Task</span><span class="o">(</span><span class="nc">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">this</span><span class="o">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">;</span>
        <span class="o">}</span>

        <span class="nd">@Override</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="nc">Thread</span><span class="o">.</span><span class="na">currentThread</span><span class="o">().</span><span class="na">getName</span><span class="o">()</span>
                    <span class="o">+</span> <span class="s">" Start. Time = "</span> <span class="o">+</span> <span class="nc">LocalDateTime</span><span class="o">.</span><span class="na">now</span><span class="o">());</span>

            <span class="n">processCommand</span><span class="o">();</span>

            <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="nc">Thread</span><span class="o">.</span><span class="na">currentThread</span><span class="o">().</span><span class="na">getName</span><span class="o">()</span>
                    <span class="o">+</span> <span class="s">" End. Time = "</span> <span class="o">+</span> <span class="nc">LocalDateTime</span><span class="o">.</span><span class="na">now</span><span class="o">());</span>
        <span class="o">}</span>

        <span class="kd">private</span> <span class="kt">void</span> <span class="nf">processCommand</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">try</span> <span class="o">{</span>
                <span class="nc">Thread</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="mi">5000</span><span class="o">);</span>
            <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">InterruptedException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
            <span class="o">}</span>
        <span class="o">}</span>

        <span class="nd">@Override</span>
        <span class="kd">public</span> <span class="nc">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span>
            <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">name</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_æ€è€ƒé¢˜"><a class="anchor" href="#_æ€è€ƒé¢˜"></a>58.6. æ€è€ƒé¢˜</h3>
<div class="paragraph">
<p>è‡ªå·±å®ç°ä¸€ä¸ªçº¿ç¨‹æ± ã€‚</p>
</div>
</div>
<div class="sect2">
<h3 id="_å‚è€ƒèµ„æ–™_14"><a class="anchor" href="#_å‚è€ƒèµ„æ–™_14"></a>58.7. å‚è€ƒèµ„æ–™</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="http://www.throwable.club/2019/07/15/java-concurrency-thread-pool-executor/">JUCçº¿ç¨‹æ± ThreadPoolExecutoræºç åˆ†æ - Throwable&#8217;s Blog</a></p>
</li>
<li>
<p><a href="https://www.cnblogs.com/leesf456/p/5585627.html">ã€JUCã€‘JDK1.8æºç åˆ†æä¹‹ThreadPoolExecutorï¼ˆä¸€ï¼‰ - leesf - åšå®¢å›­</a></p>
</li>
<li>
<p><a href="https://mp.weixin.qq.com/s/baYuX8aCwQ9PP6k7TDl2Ww">Javaçº¿ç¨‹æ± å®ç°åŸç†åŠå…¶åœ¨ç¾å›¢ä¸šåŠ¡ä¸­çš„å®è·µ</a></p>
</li>
<li>
<p><a href="http://calvin1978.blogcn.com/articles/java-threadpool.html">Java ThreadPoolçš„æ­£ç¡®æ‰“å¼€æ–¹å¼ | æ±Ÿå—ç™½è¡£</a></p>
</li>
<li>
<p><a href="http://calvin1978.blogcn.com/articles/tomcat-threadpool.html">Tomcatçº¿ç¨‹æ± ï¼Œæ›´ç¬¦åˆå¤§å®¶æƒ³è±¡çš„å¯æ‰©å±•çº¿ç¨‹æ±  | æ±Ÿå—ç™½è¡£</a></p>
</li>
<li>
<p><a href="https://mp.weixin.qq.com/s/YAeneN-x_En55FlC2mVcaA">æ¯å¤©éƒ½åœ¨ç”¨ï¼Œä½†ä½ çŸ¥é“ Tomcat çš„çº¿ç¨‹æ± æœ‰å¤šåŠªåŠ›å—ï¼Ÿ</a></p>
</li>
<li>
<p><a href="http://www.throwable.club/2019/07/15/java-concurrency-thread-pool-executor/" class="bare">http://www.throwable.club/2019/07/15/java-concurrency-thread-pool-executor/</a>[JUCçº¿ç¨‹æ± ThreadPoolExecutoræºç åˆ†æ - Throwable&#8217;s Blog</p>
</li>
<li>
<p><a href="http://jindong.io/2015/03/30/java-concurrent-package-ThreadPoolExecutor/">Javaå¹¶å‘åŒ…æºç å­¦ä¹ ä¹‹çº¿ç¨‹æ± ï¼ˆä¸€ï¼‰ThreadPoolExecutoræºç åˆ†æ - Jindong</a></p>
</li>
<li>
<p><a href="http://my.oschina.net/zouqun/blog/407149">ThreadPoolExecutorç®€ä»‹ä¸æºç åˆ†æ - é‚¹èƒœç¾¤çš„ä¸ªäººé¡µé¢ - å¼€æºä¸­å›½ç¤¾åŒº</a></p>
</li>
<li>
<p><a href="http://onlychoice.github.io/blog/2013/09/13/java-concurrent-source-code-reading-2/">Javaå¹¶å‘æºç åˆ†æ - ThreadPoolExecutor - SHOW ME THE CODE</a></p>
</li>
<li>
<p><a href="http://blog.csdn.net/xieyuooo/article/details/8718741">Javaçº¿ç¨‹æ± æ¶æ„åŸç†å’Œæºç è§£æ(ThreadPoolExecutor) - xieyuoooçš„ä¸“æ  - åšå®¢é¢‘é“ - CSDN.NET</a></p>
</li>
<li>
<p><a href="http://www.cnblogs.com/skywang12345/p/java_threads_category.html">Javaå¤šçº¿ç¨‹ç³»åˆ—ç›®å½•(å…±43ç¯‡) - å¦‚æœå¤©ç©ºä¸æ­» - åšå®¢å›­</a></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>ææ¸…æ¥šäº† <code>ctl</code> çš„å«ä¹‰ï¼Œé«˜ä¸‰ä½æ˜¯çŠ¶æ€ï¼Œä½29ä½æ˜¯çº¿ç¨‹æ•°</p>
</li>
<li>
<p>ä¸»è¦å±æ€§çš„å«ä¹‰ï¼Œä¸»è¦æ–¹æ³•çš„å®ç°ï¼Œä»»åŠ¡æ·»åŠ åï¼Œä¸‰ç§ä¸åŒçš„å¤„ç†æ–¹å¼</p>
</li>
<li>
<p>çº¿ç¨‹æ± çŠ¶æ€å˜æ¢</p>
</li>
<li>
<p>çº¿ç¨‹æ± æ‹’ç»ç­–ç•¥çš„å®ç°</p>
</li>
<li>
<p>å¸¦è¿”å›å€¼çš„ä»»åŠ¡çš„å®ç°æ–¹å¼ï¼Œ<code>Callable</code>ï¼Œ<code>Future</code></p>
</li>
</ol>
</div>
</li>
<li>
<p><a href="http://www.molotang.com/articles/514.html">ThreadPoolExecutorçš„åŸºæœ¬ä½¿ç”¨ | ä¸‰çŸ³Â·é“</a></p>
</li>
<li>
<p><a href="http://www.molotang.com/articles/522.html">ThreadPoolExecutorçš„ä»»åŠ¡æäº¤ã€ä»»åŠ¡å¤„ç†ã€çº¿ç¨‹å¤ç”¨å’Œç»´æŠ¤ç›¸å…³æºç åˆ†æ | ä¸‰çŸ³Â·é“</a></p>
</li>
<li>
<p><a href="http://www.molotang.com/articles/526.html">ThreadPoolExecutorçš„ç”Ÿå‘½å‘¨æœŸç›¸å…³æºç åˆ†æ | ä¸‰çŸ³Â·é“</a></p>
</li>
<li>
<p><a href="http://www.molotang.com/articles/553.html">ThreadPoolExecutorçš„ä»»åŠ¡é¥±å’Œä¸¢å¼ƒç­–ç•¥åŠæºç å®ç° | ä¸‰çŸ³Â·é“</a></p>
</li>
<li>
<p><a href="http://ifeve.com/java-threadpool/">èŠèŠå¹¶å‘ï¼ˆä¸‰ï¼‰Javaçº¿ç¨‹æ± çš„åˆ†æå’Œä½¿ç”¨ | å¹¶å‘ç¼–ç¨‹ç½‘ - ifeve.com</a></p>
</li>
<li>
<p><a href="http://www.infoq.com/cn/articles/executor-framework-thread-pool-task-execution-part-01?utm_campaign=rightbar_v2&amp;utm_source=infoq&amp;utm_medium=articles_link&amp;utm_content=link_text">æˆï¼ˆç»†ï¼‰è¯´Executoræ¡†æ¶çº¿ç¨‹æ± ä»»åŠ¡æ‰§è¡Œå…¨è¿‡ç¨‹ï¼ˆä¸Šï¼‰</a></p>
</li>
<li>
<p><a href="http://www.infoq.com/cn/articles/executor-framework-thread-pool-task-execution-part-02?utm_campaign=rightbar_v2&amp;utm_source=infoq&amp;utm_medium=articles_link&amp;utm_content=link_text">æˆï¼ˆç»†ï¼‰è¯´Executoræ¡†æ¶çº¿ç¨‹æ± ä»»åŠ¡æ‰§è¡Œå…¨è¿‡ç¨‹ï¼ˆä¸‹ï¼‰</a></p>
</li>
<li>
<p><a href="http://blog.csdn.net/techq/article/details/6818201">ThreadPoolExecutor æºç åˆ†æ - techqâ€™s blog - åšå®¢é¢‘é“ - CSDN.NET</a></p>
</li>
<li>
<p><a href="http://blog.sina.com.cn/s/blog_753035050100wbtm.html">JAVAçº¿ç¨‹æ± (ThreadPoolExecutor)æºç åˆ†æ_journeylin_æ–°æµªåšå®¢</a></p>
</li>
<li>
<p><a href="http://www.cnblogs.com/rilley/archive/2012/02/07/2341767.html">ThreadPoolExecutoræºç åˆ†æ - rilley - åšå®¢å›­</a></p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="paragraph nav-footer">
<p>â†Â Previous:Â <a href="java.util.concurrent.CompletableFuture.html">CompletableFuture</a>Â | â†‘Â Up:Â <a href="index.html">JDK æºç åˆ†æ</a>Â | Next:Â <a href="java.util.concurrent.ForkJoinTask.html">ForkJoinTask</a>Â â†’</p>
</div>
<script src="https://giscus.app/client.js" data-repo="diguage/jdk-source-analysis" data-repo-id="MDEwOlJlcG9zaXRvcnk3MjM5MzE5Mw==" data-category="General" data-category-id="MDE4OkRpc2N1c3Npb25DYXRlZ29yeTMyMDM2MDQx" data-mapping="og:title" data-strict="0" data-reactions-enabled="1" data-emit-metadata="1" data-input-position="top" data-theme="preferred_color_scheme" data-lang="zh-CN" data-loading="lazy" crossorigin="anonymous" async></script>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2025-11-25 13:40:54 UTC
</div>
</div>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  messageStyle: "none",
  tex2jax: {
    inlineMath: [["\\(", "\\)"]],
    displayMath: [["\\[", "\\]"]],
    ignoreClass: "nostem|nolatexmath"
  },
  asciimath2jax: {
    delimiters: [["\\$", "\\$"]],
    ignoreClass: "nostem|noasciimath"
  },
  TeX: { equationNumbers: { autoNumber: "none" } }
})
MathJax.Hub.Register.StartupHook("AsciiMath Jax Ready", function () {
  MathJax.InputJax.AsciiMath.postfilterHooks.Add(function (data, node) {
    if ((node = data.script.parentNode) && (node = node.parentNode) && node.classList.contains("stemblock")) {
      data.math.root.display = "block"
    }
    return data
  })
})
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<script src="assets/scripts/asciidoctor-tabs.js"></script>
<script src="assets/scripts/scroll-toc.js"></script></body>
</html>